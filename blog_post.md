Lessons learned:
* Lazy load imports (even innocous ones lead to noticeable delay)
* Generators of batches (but find proof for this is needed by playing with parameters)
* Multithread where needed (again do some profiling)
